# encoding: utf-8

require 'csv'
require 'awesome_print'

hash = {}
conf = {"城市"=>"city_name", "MultiFactor"=>"multi_factor", "新地域id"=>"new_geo_id", "旧地域id"=>"old_geo_id", "PPL"=>"ppl", "Netizen"=>"netizen", "iCVG%"=>"icvg", "M12"=>"M12", "M13"=>"M13", "M14"=>"M14", "M15"=>"M15", "M16"=>"M16", "M17"=>"M17", "M18"=>"M18", "M19"=>"M19", "M20"=>"M20", "M21"=>"M21", "M22"=>"M22", "M23"=>"M23", "M24"=>"M24", "M25"=>"M25", "M26"=>"M26", "M27"=>"M27", "M28"=>"M28", "M29"=>"M29", "M30"=>"M30", "M31"=>"M31", "M32"=>"M32", "M33"=>"M33", "M34"=>"M34", "M35"=>"M35", "M36"=>"M36", "M37"=>"M37", "M38"=>"M38", "M39"=>"M39", "M40"=>"M40", "M41"=>"M41", "M42"=>"M42", "M43"=>"M43", "M44"=>"M44", "M45"=>"M45", "M46"=>"M46", "M47"=>"M47", "M48"=>"M48", "M49"=>"M49", "M50"=>"M50", "M51"=>"M51", "M52"=>"M52", "M53"=>"M53", "M54"=>"M54", "M55"=>"M55", "M56"=>"M56", "M57"=>"M57", "M58"=>"M58", "M59"=>"M59", "M60"=>"M60", "M61"=>"M61", "M62"=>"M62", "M63"=>"M63", "M64"=>"M64", "F12"=>"F12", "F13"=>"F13", "F14"=>"F14", "F15"=>"F15", "F16"=>"F16", "F17"=>"F17", "F18"=>"F18", "F19"=>"F19", "F20"=>"F20", "F21"=>"F21", "F22"=>"F22", "F23"=>"F23", "F24"=>"F24", "F25"=>"F25", "F26"=>"F26", "F27"=>"F27", "F28"=>"F28", "F29"=>"F29", "F30"=>"F30", "F31"=>"F31", "F32"=>"F32", "F33"=>"F33", "F34"=>"F34", "F35"=>"F35", "F36"=>"F36", "F37"=>"F37", "F38"=>"F38", "F39"=>"F39", "F40"=>"F40", "F41"=>"F41", "F42"=>"F42", "F43"=>"F43", "F44"=>"F44", "F45"=>"F45", "F46"=>"F46", "F47"=>"F47", "F48"=>"F48", "F49"=>"F49", "F50"=>"F50", "F51"=>"F51", "F52"=>"F52", "F53"=>"F53", "F54"=>"F54", "F55"=>"F55", "F56"=>"F56", "F57"=>"F57", "F58"=>"F58", "F59"=>"F59", "F60"=>"F60", "F61"=>"F61", "F62"=>"F62", "F63"=>"F63", "F64"=>"F64"}

CSV.foreach("./data/igrp_new_cities.csv") do |row|
  tmp = {}
  i = 0
  conf.each do |k, v|
    tmp[v] = row[i]
    tmp[v] = row[i].to_f.round.to_s if v == "ppl"
    i += 1
  end
  hash[row[3]] = tmp
end
ap hash
